[global]

  workgroup = <%= node["samba"]["workgroup"] %>

# server string is the equivalent of the NT Description field
  server string = %h server

# This will prevent nmbd to search for NetBIOS names through DNS.
  dns proxy = <%= node["samba"]["dns_proxy"] %>

#### Debugging/Accounting ####

# This tells Samba to use a separate log file for each machine
# that connects
  log file = <%= node["samba"]["log_dir"] %>

# Cap the size of the individual log files (in KiB).
  max log size = 1000

# If you want Samba to only log through syslog then set the following
# parameter to 'yes'.
#   syslog only = no

# We want Samba to log a minimum amount of information to syslog. Everything
# should go to /var/log/samba/log.{smbd,nmbd} instead. If you want to log
# through syslog you should set the following parameter to something higher.
  syslog = 0

# Do something sensible when Samba crashes: mail the admin a backtrace
  panic action = /usr/share/samba/panic-action %d


####### Authentication #######

# "security = user" is always a good idea. This will require a Unix account
# in this server for every user accessing the server. See
# /usr/share/doc/samba-doc/htmldocs/Samba3-HOWTO/ServerType.html
# in the samba-doc package for details.
#   security = user
  security = <%= node["samba"]["security"] %>
  encrypt passwords = true
  passdb backend = <%= node["samba"]["passdb_backend"] %>
  obey pam restrictions = yes
  unix password sync = yes
  password program = /usr/bin/passwd %u
  
  


#======================= Share Definitions =======================

[<%= node["samba"]["folder"]["name"] %>]
  comment = <%= node["samba"]["folder"]["comment"] %>
  path = <%= node["samba"]["folder"]["path"] %>
  public = <%= node["samba"]["folder"]["public"] %>
  writable = <%= node["samba"]["folder"]["writable"] %>
  create mask = <%= node["samba"]["folder"]["create mask"] %>
  directory mask = <%= node["samba"]["folder"]["directory mask"] %>
  force user = nobody
  force group = nogroup